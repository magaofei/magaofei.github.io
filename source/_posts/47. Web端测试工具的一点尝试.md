---
title: Web端测试工具的一点尝试
date: 2018-04-05 19:31:00
tags:
  - 测试
---

# Web端测试工具的一点尝试

在测试工作期间有一件很占据时间且很不必要的事情，就是造数据，来到现在这个团队后，为了解决这个需求，我们做了一点尝试，在这里分享一下。



#### 举个创建直播的例子

这是一家教育公司，部门做在线教育，既然是在线就要上课，我们把每次上课归类为一个直播，测试当中需要频繁的创建符合要求的直播。


以前的流程是 登录后台—>创建直播—>关联直播到指定日期的课程中—>去另外一个平台关联讲义(可选)

改造后的流程 登录QA测试工具网站—>创建直播并关联指定课程和讲义。

用一个表单去解决这些事情，其实就是重新做了一个前端出来，我们把一些主要的接口抽离出来，自己去实现这些功能，只保留一些必要的参数，比如名称、老师名、课程id，其他的可以给一个默认值，比如日期默认当天，设定默认科目、年级、讲义。之前可能需要3~10分钟去做的一件事，现在输入几个数值，点几下鼠标就可以了，可以说极大的加快了测试的效率。而且不仅测试在用，包括技术支持、部分开发、其他业务部分也会使用到，如果在以前可能需要测试帮忙造数据，不仅慢，还很不情愿，现在只需要给他们开个帐号就可以了。

为了方便测试，我们也支持线上，不过做了严格限制，只有符合指定条件的才能够创建。
给大家放一个API的使用量统计图

![](http://os19wcerd.bkt.clouddn.com/20180405195818_jLKTvb_Screenshot.jpeg)

当然还有其他的一些功能，比如查询用户购买的课程、报名课程、查询直播信息等，以前这些可能需要手动操作或者查询数据库，现在使用表单就可以完成了。

界面：

![](http://os19wcerd.bkt.clouddn.com/20180405203016_dfO6av_Screenshot.jpeg)



#### 遇到的坑
在这当中有一个步骤是关联课程，关联课程的接口需要传入一个直播id，也就是刚刚创建好的直播，可后端没有任何返回。

我的思路是到数据库查符合条件最新的那个，本身没有问题，运行了一段，有同事反馈说有偶现BUG——创建直播讲之后关联失败。一直无法复现，直到有一次问题出现了1分多钟，才发现了问题所在，是因为主从库延迟的问题。运维给的是从库，而主从库有延迟，主库有数据，从库没有查到，并且我们不可能有访问主库的权限，后来我又想到加一个查库的轮询，每隔一个时间段就查一次数据，这下应该没什么问题了吧？后来发现有接口超时，轮询的时候接口本身就超时了，还想让开发改下代码，返回ID，我看了下那段代码，已经有3年多了，写的挺烂的，我估计谁都不想碰，而且改了还得测吧？最后只得自己想办法，想到了一个方案，请求关联课程的HTML网页，再用一个正则，把直播讲ID取到，才解决了这个问题。


#### 技术实现

目前主要使用 Django + Vue ，尽量做到前后端分离。





